# 正则表达式的使用（一）
## 参考
《正则表达式30分钟入门教程》：**http://www.cnblogs.com/deerchao/archive/2006/08/24/zhengzhe30fengzhongjiaocheng.html**

上面这篇介绍了正则表达式的基础知识，但是对于零宽断言没有展开来讲，零宽断言看下面这篇：

《正则表达式之：零宽断言不『消费』》：**http://fxck.it/post/50558232873**


##测试
测试你自己写的正则表达式，建议上这里：**http://refiddle.com/** ，可以所见即所得地调试。

##内容

### 元字符

代码 | <font color="	#DC143C">常用的元字符</font>说明 | 注释
--------|-----------|------
.	| 匹配除换行符以外的任意字符 | 
\w	| 匹配字母或数字或下划线或汉字 | word
\s	| 匹配任意的空白符 | space
\d	| 匹配数字 | digit
\b	| 匹配单词的开始或结束 | border
^	| 匹配字符串的开始 
$	| 匹配字符串的结束

<font color="#DC143C">`0\d\d-\d\d\d\d\d\d\d\d`</font> 匹配这样的字符串：以0开头，然后是两个数字，然后是一个连字号“-”，最后是8个数字。

<font color="#DC143C">`[0\d{2}-\d{8}]`</font> 这里\d后面的{2}({8})的意思是前面\d必须连续重复匹配2次(8次)。

<font color="#DC143C">`\ba\w*\b`</font> 匹配以字母a开头的单词——先是某个单词开始处(\b)，然后是字母a,然后是任意数量的字母或数字(\w*)，最后是单词结束处(\b)。

<font color="#DC143C">`\d+`</font> 匹配1个或更多连续的数字。这里的+是和*类似的元字符，不同的是*匹配重复任意次(可能是0次)，而+则匹配重复1次或更多次。

<font color="#DC143C">`\b\w{6}\b`</font> 匹配刚好6个字符的单词。

<font color="#DC143C">`^\d{5,12}$`</font> 匹配5位到12位数字；这里的{5,12}和前面介绍过的{2}是类似的，只不过{2}匹配只能不多不少重复2次，{5,12}则是重复的次数不能少于5次，不能多于12次，否则都不匹配。

<font color="#DC143C">`Windows\d+`</font> 匹配Windows后面跟1个或更多数字

<font color="#DC143C">`^\w+`</font> 匹配一行的第一个单词(或整个字符串的第一个单词，具体匹配哪个意思得看选项设置)

代码 | <font color="	#DC143C">常用的限定符</font>说明 | 注释
--------|-----------|------
*	| 重复零次或更多次
+	| 重复一次或更多次
?	| 重复零次或一次
{n}	| 重复n次
{n,}	| 重复n次或更多次
{n,m}	| 重复n到m次

### 字符转义
如果你想查找元字符本身的话，比如你查找<font color="#DC143C">`.`</font>,或者<font color="#DC143C">`*`</font>,就出现了问题：你没办法指定它们，因为它们会被解释成别的意思。这时你就得使用<font color="#DC143C">`\`</font>来取消这些字符的特殊意义。因此，你应该使用<font color="#DC143C">`\.`</font>和<font color="#DC143C">`\*`</font>。当然，要查找<font color="#DC143C">`\`</font>本身，你也得用<font color="#DC143C">`\\`</font>.
例如：unibetter\.com匹配unibetter.com，C:\\Windows匹配C:\Windows。

### 字符类
<font color="#DC143C">`[aeiou]`</font> 匹配任何一个英文元音字母

<font color="#DC143C">`[.?!]`</font> 匹配标点符号(.或?或!)。

<font color="#DC143C">`[0-9]`</font> 代表的含意与\d就是完全一致的：一位数字；同理<font color="#DC143C">`[a-z0-9A-Z_]`</font> 也完全等同于\w（如果只考虑英文的话）。

<font color="#DC143C">`\(?0\d{2}[) -]?\d{8}`</font>  这个表达式可以匹配几种格式的电话号码，像(010)88886666，或022-22334455，或02912345678等。首先是一个转义字符\(,它能出现0次或1次(?),然后是一个0，后面跟着2个数字(\d{2})，然后是)或-或空格中的一个，它出现1次或不出现(?)，最后是8个数字(\d{8})。

* [] 表示之一
* | 表示或
* ？表示0或1，这么说不准确，应尽可能的少，详见下章：贪婪一节

### 分支条件

正则表达式里的分枝条件指的是有几种规则，如果满足其中任意一种规则都应该当成匹配，具体方法是用<font color="#DC143C">`|`</font>把不同的规则分隔开。看例子：

<font color="#DC143C">`0\d{2}-\d{8}|0\d{3}-\d{7}`</font> 这个表达式能匹配两种以连字号分隔的电话号码：一种是三位区号，8位本地号(如010-12345678)，一种是4位区号，7位本地号(0376-2233445)。

<font color="#DC143C">`\(0\d{2}\)[- ]?\d{8}|0\d{2}[- ]?\d{8}`</font> 这个表达式匹配3位区号的电话号码，其中区号可以用小括号括起来，也可以不用，区号与本地号间可以用连字号或空格间隔，也可以没有间隔。你可以试试用分枝条件把这个表达式扩展成也支持4位区号的。

<font color="#DC143C">`\d{5}-\d{4}|\d{5}`</font> 这个表达式用于匹配美国的邮政编码。美国邮编的规则是5位数字，或者用连字号间隔的9位数字。之所以要给出这个例子是因为它能说明一个问题：使用分枝条件时，要注意各个条件的顺序。如果你把它改成<font color="#DC143C">`\d{5}|\d{5}-\d{4}`</font> 的话，那么就只会匹配5位的邮编(以及9位邮编的前5位)。原因是匹配分枝条件时，将会从左到右地测试每个条件，如果满足了某个分枝的话，就不会去再管其它的条件了。


### 分组
我们已经提到了怎么重复单个字符（直接在字符后面加上限定符就行了）；但如果想要重复多个字符又该怎么办？你可以用小括号来指定子表达式(也叫做分组)。

<font color="#DC143C">`(\d{1,3}\.){3}\d{1,3}`</font>是一个简单的IP地址匹配表达式。要理解这个表达式，请按下列顺序分析它：<font color="green">`\d{1,3}`</font>匹配1到3位的数字，<font color="green">`(\d{1,3}\.){3}`</font>匹配三位数字加上一个英文句号(这个整体也就是这个分组)重复3次，最后再加上一个一到三位的数字<font color="green">`(\d{1,3})`</font>。

### 反义

代码 | <font color="#DC143C"></font>常用的反义代码说明
-----|------
`\W`	| 匹配任意不是字母，数字，下划线，汉字的字符
`\S`	| 匹配任意不是空白符的字符
`\D`	| 匹配任意非数字的字符
`\B`	| 匹配不是单词开头或结束的位置
`[^x]`	| 匹配除了x以外的任意字符
`[^aeiou]`	| 匹配除了aeiou这几个字母以外的任意字符

<font color="#DC143C">`\S+`</font>匹配不包含空白符的字符串。

<font color="#DC143C">`<a[^>]+>`</font>匹配用尖括号括起来的以a开头的字符串。

### 后向引用

使用小括号指定一个子表达式后，**匹配这个子表达式的文本**(也就是**此分组捕获的内容**)可以在表达式或其它程序中作进一步的处理。默认情况下，每个分组会自动拥有一个组号，规则是：**从左向右，以分组的左括号为标志**，第一个出现的分组的组号为1，第二个为2，以此类推。

后向引用用于**重复搜索前面某个分组匹配的文本**。例如，**\1代表分组1匹配的文本**。请看示例：

<font color="#DC143C">`\b(\w+)\b\s+\1\b`</font>可以用来匹配重复的单词，像go go, 或者kitty kitty。这个表达式首先是一个单词，也就是单词开始处和结束处之间的多于一个的字母或数字<font color="green">`(\b(\w+)\b)`</font>，这个单词会被捕获到编号为1的分组中，然后是1个或几个空白符<font color="green">`(\s+)`</font>，最后是分组1中捕获的内容（也就是前面匹配的那个单词）<font color="green">`(\1)`</font>。

你也可以自己指定子表达式的组名。要指定一个子表达式的组名，请使用这样的语法：(?<Word>\w+)(或者把尖括号换成'也行：(?'Word'\w+)),这样就把\w+的组名指定为Word了。要反向引用这个分组捕获的内容，你可以使用\k<Word>,所以上一个例子也可以写成这样：\b(?<Word>\w+)\b\s+\k<Word>\b。

分类 | <font color="#DC143C">常用分组语法</font> | 说明
----|---|----
捕获 |`(exp)`	| 匹配exp,并捕获文本到自动命名的组里
（同上）|`(?<name>exp)`	| 匹配exp,并捕获文本到名称为name的组里，也可以写成(?'name'exp)
（同上） |`(?:exp)`	| 匹配exp,不捕获匹配的文本，也不给此分组分配组号
零宽断言	|(?=exp) | 	匹配exp前面的位置
 （同上） | (?<=exp)	|匹配exp后面的位置
 （同上） |(?!exp)	|匹配后面跟的不是exp的位置
 （同上） |(?<!exp)	|匹配前面不是exp的位置
注释|	(?#comment)	|这种类型的分组不对正则表达式的处理产生任何影响，用于提供注释让人阅读

* 分组0对应整个正则表达式
* 实际上组号分配过程是要从左向右扫描两遍的：第一遍只给未命名组分配，第二遍只给命名组分配－－因此所有命名组的组号都大于未命名的组号
* 你可以使用(?:exp)这样的语法来剥夺一个分组对组号分配的参与权


